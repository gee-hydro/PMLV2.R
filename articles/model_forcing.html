<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>model_forcing â€¢ PMLV2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="model_forcing">
<meta property="og:description" content="PMLV2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PMLV2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/model_forcing.html">model_forcing</a>
    </li>
    <li>
      <a href="../articles/run_model.html">run_model</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>model_forcing</h1>
            
      
      
      <div class="hidden name"><code>model_forcing.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="illustration-of-meteorological-forcing">1. Illustration of Meteorological forcing<a class="anchor" aria-label="anchor" href="#illustration-of-meteorological-forcing"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">PMLV2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'Ipaper':</span></span>
<span><span class="co">#&gt;   method           from      </span></span>
<span><span class="co">#&gt;   print.data.table data.table</span></span>
<span><span class="co">#&gt; The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,</span></span>
<span><span class="co">#&gt; which was just loaded, will retire in October 2023.</span></span>
<span><span class="co">#&gt; Please refer to R-spatial evolution reports for details, especially</span></span>
<span><span class="co">#&gt; https://r-spatial.org/r/2023/05/15/evolution4.html.</span></span>
<span><span class="co">#&gt; It may be desirable to make the sf package available;</span></span>
<span><span class="co">#&gt; package maintainers should consider adding sf to Suggests:.</span></span>
<span><span class="co">#&gt; The sp package is now running under evolution status 2</span></span>
<span><span class="co">#&gt;      (status 2 uses the sf package in place of rgdal)</span></span>
<span><span class="co">#&gt; Please note that 'maptools' will be retired during October 2023,</span></span>
<span><span class="co">#&gt; plan transition at your earliest convenience (see</span></span>
<span><span class="co">#&gt; https://r-spatial.org/r/2023/05/15/evolution4.html and earlier blogs</span></span>
<span><span class="co">#&gt; for guidance);some functionality will be moved to 'sp'.</span></span>
<span><span class="co">#&gt;  Checking rgeos availability: FALSE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.7.46</span></span>
<span></span>
<span><span class="va">dir_root</span> <span class="op">=</span> <span class="st">"PMLV2_forcing_NorthChina/MCD12Q1_006_IGBP/"</span></span>
<span></span>
<span><span class="va">indir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"PMLV2_forcing_NorthChina/MCD12Q1_006_IGBP/"</span>, package <span class="op">=</span> <span class="st">"PMLV2"</span><span class="op">)</span></span>
<span><span class="va">fs_lc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">indir</span>, <span class="st">"*.tif"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">indir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"PMLV2_forcing_NorthChina/mete_GLDASV21/"</span>, package <span class="op">=</span> <span class="st">"PMLV2"</span><span class="op">)</span></span>
<span><span class="va">fs_mete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">indir</span>, <span class="st">"*.nc"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">fs_lc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "MCD12Q1_006_IGBP_perc_G025_NorthChina_2019.tif"</span></span>
<span><span class="co">#&gt; [2] "MCD12Q1_006_IGBP_perc_G025_NorthChina_2020.tif"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">fs_mete</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "PMLV2_forcing_NorthChina_GLDASV21_2019.nc"</span></span>
<span><span class="co">#&gt; [2] "PMLV2_forcing_NorthChina_GLDASV21_2020.nc"</span></span></code></pre></div>
<p>Have a look about those data:</p>
<div class="section level3">
<h3 id="igbp">1.1. IGBP<a class="anchor" aria-label="anchor" href="#igbp"></a>
</h3>
<p>IGBP is from <code>MCD12Q1_006_IGBP</code>(<a href="https://developers.google.com/earth-engine/datasets/catalog/MODIS_006_MCD12Q1" class="external-link uri">https://developers.google.com/earth-engine/datasets/catalog/MODIS_006_MCD12Q1</a>).</p>
<p><a href="https://code.earthengine.google.com/5fb1bd3c6245799c85e993d687dfffb2" class="external-link uri">https://code.earthengine.google.com/5fb1bd3c6245799c85e993d687dfffb2</a></p>
<blockquote>
<p>0.25Â°Ã—0.25Â°, 18 kinds of IGBP, the fraction of each IGBP in a
0.25Â°Ã—0.25Â° grid. I prepared this data on the GEE.</p>
</blockquote>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">fs_lc</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 48, 52, 18  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.25, 0.25  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 110, 123, 31, 43  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source      : MCD12Q1_006_IGBP_perc_G025_NorthChina_2019.tif </span></span>
<span><span class="co">#&gt; names       : UNC,  ENF, EBF,        DNF,      DBF,       MF, ... </span></span>
<span><span class="co">#&gt; min values  :   0, 0.00,   0, 0.00000000,  0.00000,  0.00000, ... </span></span>
<span><span class="co">#&gt; max values  :   0, 2.25,   0, 0.04666667, 77.63778, 51.89778, ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "UNC"   "ENF"   "EBF"   "DNF"   "DBF"   "MF"    "CSH"   "OSH"   "WSA"  </span></span>
<span><span class="co">#&gt; [10] "SAV"   "GRA"   "WET"   "CRO"   "URB"   "CNV"   "SNO"   "BSV"   "water"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="meteorological-forcing">1.2. Meteorological forcing<a class="anchor" aria-label="anchor" href="#meteorological-forcing"></a>
</h3>
<p><code>PMLV2_forcing_NorthChina_GLDASV21_2000.nc</code> is a ncfile,
with the variables of:</p>
<p><code>c("LAI", "Emiss", "Albedo", "Tmax", "Tmin", "Tavg", "q", "Rln", "Rs", "Pa", "U2", "Prcp")</code></p>
<blockquote>
<p>I prepared this data also on the GEE.</p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">fs_mete</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 48, 52, 552  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.25, 0.25  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 110, 123, 31, 43  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; sources     : PMLV2_forcing_NorthChina_GLDASV21_2019.nc:LAI  (46 layers) </span></span>
<span><span class="co">#&gt;               PMLV2_forcing_NorthChina_GLDASV21_2019.nc:Emiss  (46 layers) </span></span>
<span><span class="co">#&gt;               PMLV2_forcing_NorthChina_GLDASV21_2019.nc:Albedo  (46 layers) </span></span>
<span><span class="co">#&gt;               ... and 9 more source(s)</span></span>
<span><span class="co">#&gt; varnames    : LAI </span></span>
<span><span class="co">#&gt;               Emiss </span></span>
<span><span class="co">#&gt;               Albedo </span></span>
<span><span class="co">#&gt;               ...</span></span>
<span><span class="co">#&gt; names       : LAI_1, LAI_2, LAI_3, LAI_4, LAI_5, LAI_6, ... </span></span>
<span><span class="co">#&gt; time        : 2019-01-01 to 2019-12-27 UTC</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/names.html" class="external-link">varnames</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "LAI"    "Emiss"  "Albedo" "Tmax"   "Tmin"   "Tavg"   "q"      "Rln"   </span></span>
<span><span class="co">#&gt;  [9] "Rs"     "Pa"     "U2"     "Prcp"</span></span></code></pre></div>
<div class="section level4">
<h4 id="unit-of-input-forcing">1.2.1. Unit of input forcing<a class="anchor" aria-label="anchor" href="#unit-of-input-forcing"></a>
</h4>
<p><strong>Table 1.</strong> Variables in the PMLV2 model.</p>
<table class="table">
<thead><tr class="header">
<th>variable</th>
<th>Longname</th>
<th>Unit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>LAI</code></td>
<td>Leaf are index</td>
<td>-</td>
</tr>
<tr class="even">
<td><code>Emiss</code></td>
<td>Emissivity</td>
<td>-</td>
</tr>
<tr class="odd">
<td><code>Albedo</code></td>
<td>Albedo</td>
<td>-</td>
</tr>
<tr class="even">
<td><code>Tmax</code></td>
<td>Maximum temperature</td>
<td>â„ƒ</td>
</tr>
<tr class="odd">
<td><code>Tmin</code></td>
<td>Minimum temperature</td>
<td>â„ƒ</td>
</tr>
<tr class="even">
<td><code>Tavg</code></td>
<td>Average temperature</td>
<td>â„ƒ</td>
</tr>
<tr class="odd">
<td><code>q</code></td>
<td>Specific humidity</td>
<td>kg/kg</td>
</tr>
<tr class="even">
<td><code>Rln</code></td>
<td>Downward longwave radiation</td>
<td>W m-2</td>
</tr>
<tr class="odd">
<td><code>Rs</code></td>
<td>Downward shortwave radiation</td>
<td>W m-2</td>
</tr>
<tr class="even">
<td><code>Pa</code></td>
<td>Air Pressure</td>
<td>kPa</td>
</tr>
<tr class="odd">
<td><code>U2</code></td>
<td>Wind speed in <strong><u>2 meter</u></strong>
</td>
<td>m/s</td>
</tr>
<tr class="even">
<td><code>Prcp</code></td>
<td>Precipitation</td>
<td>mm/d</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="prepare-input">1.3. Prepare input<a class="anchor" aria-label="anchor" href="#prepare-input"></a>
</h3>
<div class="section level4">
<h4 id="convert-original-data-into-8-day-on-the-gee">1.3.1. Convert original data into 8-day on the GEE<a class="anchor" aria-label="anchor" href="#convert-original-data-into-8-day-on-the-gee"></a>
</h4>
<ol style="list-style-type: decimal">
<li><p><code>ERA5L hourly to 8-day</code>: <a href="https://code.earthengine.google.com/693b6ee233f8cf5dcc7c2e1579631967" class="external-link uri">https://code.earthengine.google.com/693b6ee233f8cf5dcc7c2e1579631967</a></p></li>
<li><p><code>GLDAS 3hourly to 80day</code>: <a href="https://code.earthengine.google.com/57102f28df2690cdae5b742f97561136" class="external-link uri">https://code.earthengine.google.com/57102f28df2690cdae5b742f97561136</a></p></li>
</ol>
<blockquote>
<p>You donâ€™t have the access to GEE gee_PML2. It will not available
until my new paper published.</p>
</blockquote>
</div>
<div class="section level4">
<h4 id="download-them-from-gee">1.3.2. Download them from GEE<a class="anchor" aria-label="anchor" href="#download-them-from-gee"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># go to GEE</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="tidy-downloaded-tiff-file-and-convert-them-to-nc">1.3.3. Tidy downloaded tiff file, and convert them to nc<a class="anchor" aria-label="anchor" href="#tidy-downloaded-tiff-file-and-convert-them-to-nc"></a>
</h4>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dongdong Kong.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
